{"version":3,"file":"spawn.js","names":["_crossSpawn","_interopRequireDefault","require","e","__esModule","default","spawn","args","Promise","resolve","reject","child","crossSpawn","stdout","stderr","setEncoding","on","data","once","code","trim","error","Error","String","Object","defineProperties","enumerable","value","exports"],"sources":["../../src/utils/spawn.ts"],"sourcesContent":["import crossSpawn from 'cross-spawn';\n\nexport const spawn = async (...args: Parameters<typeof crossSpawn>) => {\n  return new Promise<string>((resolve, reject) => {\n    const child = crossSpawn(...args);\n\n    let stdout = '';\n    let stderr = '';\n\n    child.stdout?.setEncoding('utf8');\n    child.stdout?.on('data', (data: string) => {\n      stdout += data;\n    });\n\n    child.stderr?.setEncoding('utf8');\n    child.stderr?.on('data', (data: string) => {\n      stderr += data;\n    });\n\n    child.once('error', reject);\n    child.once('close', (code) => {\n      if (code === 0) {\n        resolve(stdout.trim());\n      } else {\n        const error = new Error(\n          stderr.trim() || `Command exited with code ${String(code)}`\n        );\n\n        Object.defineProperties(error, {\n          stdout: {\n            enumerable: false,\n            value: stdout,\n          },\n          stderr: {\n            enumerable: false,\n            value: stderr,\n          },\n          code: {\n            enumerable: false,\n            value: code,\n          },\n        });\n\n        reject(error);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,WAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAqC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE9B,MAAMG,KAAK,GAAG,MAAAA,CAAO,GAAGC,IAAmC,KAAK;EACrE,OAAO,IAAIC,OAAO,CAAS,CAACC,OAAO,EAAEC,MAAM,KAAK;IAC9C,MAAMC,KAAK,GAAG,IAAAC,mBAAU,EAAC,GAAGL,IAAI,CAAC;IAEjC,IAAIM,MAAM,GAAG,EAAE;IACf,IAAIC,MAAM,GAAG,EAAE;IAEfH,KAAK,CAACE,MAAM,EAAEE,WAAW,CAAC,MAAM,CAAC;IACjCJ,KAAK,CAACE,MAAM,EAAEG,EAAE,CAAC,MAAM,EAAGC,IAAY,IAAK;MACzCJ,MAAM,IAAII,IAAI;IAChB,CAAC,CAAC;IAEFN,KAAK,CAACG,MAAM,EAAEC,WAAW,CAAC,MAAM,CAAC;IACjCJ,KAAK,CAACG,MAAM,EAAEE,EAAE,CAAC,MAAM,EAAGC,IAAY,IAAK;MACzCH,MAAM,IAAIG,IAAI;IAChB,CAAC,CAAC;IAEFN,KAAK,CAACO,IAAI,CAAC,OAAO,EAAER,MAAM,CAAC;IAC3BC,KAAK,CAACO,IAAI,CAAC,OAAO,EAAGC,IAAI,IAAK;MAC5B,IAAIA,IAAI,KAAK,CAAC,EAAE;QACdV,OAAO,CAACI,MAAM,CAACO,IAAI,CAAC,CAAC,CAAC;MACxB,CAAC,MAAM;QACL,MAAMC,KAAK,GAAG,IAAIC,KAAK,CACrBR,MAAM,CAACM,IAAI,CAAC,CAAC,IAAI,4BAA4BG,MAAM,CAACJ,IAAI,CAAC,EAC3D,CAAC;QAEDK,MAAM,CAACC,gBAAgB,CAACJ,KAAK,EAAE;UAC7BR,MAAM,EAAE;YACNa,UAAU,EAAE,KAAK;YACjBC,KAAK,EAAEd;UACT,CAAC;UACDC,MAAM,EAAE;YACNY,UAAU,EAAE,KAAK;YACjBC,KAAK,EAAEb;UACT,CAAC;UACDK,IAAI,EAAE;YACJO,UAAU,EAAE,KAAK;YACjBC,KAAK,EAAER;UACT;QACF,CAAC,CAAC;QAEFT,MAAM,CAACW,KAAK,CAAC;MACf;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACO,OAAA,CAAAtB,KAAA,GAAAA,KAAA","ignoreList":[]}